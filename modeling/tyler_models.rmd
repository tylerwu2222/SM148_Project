---
title: "tyler models"
output: pdf_document
---

```{r}
library(tidyverse)
```

# select columns to model with
- goal: predicting sentiment (polarity)/subjectivity with other columns
```{r}
data = read_csv("../complete_data/complete_data_cases.csv")
head(data)
```
```{r}
CA_data <- data %>% filter(CA == "Yes")
LA_data <- data %>% filter(LA == "Yes")
nrow(CA_data)
nrow(LA_data)
```

```{r}
colnames(CA_data)
```
```{r}
max(CA_data$Confirmed,na.rm=T)
```

# try plotting sentiment over time?
```{r}

fit1 <- lm(Polarity~Confirmed, data=CA_data)
fit2 <- lm(Polarity~poly(Confirmed,2,raw=TRUE), data=CA_data)
fit3 <- lm(Polarity~poly(Confirmed,3,raw=TRUE), data=CA_data)
# fit4 <- lm(Polarity~poly(date,4,raw=TRUE), data=CA_data)
# fit5 <- lm(Polarity~poly(date,5,raw=TRUE), data=CA_data)

#create a scatterplot of x vs. y
plot(CA_data$Confirmed, CA_data$Polarity, pch=19, xlab='x', ylab='y')

#define x-axis values
x_axis <- seq(0, max(CA_data$Confirmed,na.rm=T))

#add curve of each model to plot
lines(x_axis, predict(fit1, data.frame(Confirmed=x_axis)), col='green')
lines(x_axis, predict(fit2, data.frame(Confirmed=x_axis)), col='red')
lines(x_axis, predict(fit3, data.frame(Confirmed=x_axis)), col='purple')
# lines(x_axis, predict(fit4, data.frame(x=x_axis)), col='blue')
# lines(x_axis, predict(fit5, data.frame(x=x_axis)), col='orange')
```


# testing lm only mask mandate
- low R^2, expected since many other things explain sentiment?
```{r}
predictors = colnames(CA_data)[c(5,6,15,21,24,25,26,32)] # likes, retweets, mandate, text mentions mask, confirmed cases, deaths, recovered, tested people

CA_lin_sent1 <- lm(formula=as.formula(paste("Polarity",predictors[3],sep="~")),
                    data=CA_data,
                    family="gaussian")
summary(CA_lin_sent1)
```

### mask mandates and mentions mask
- sentiment is significantly different in tweets that do & don't mention mask
- but still very low significance
```{r}
CA_lin_sent2 <- lm(formula=as.formula(paste("Polarity",paste(predictors[c(3,4)],
                                                              collapse="+"),sep="~")),
                    data = CA_data,
                    family = "gaussian")
summary(CA_lin_sent2)
```

### only covid stats
- none significant...
- negative R^2...
```{r}
CA_lin_sent3 <- lm(formula=as.formula(paste("Polarity",paste(predictors[c(5:8)],
                                                              collapse="+"),sep="~")),
                    data = CA_data,
                    family = "gaussian")
summary(CA_lin_sent3)
```

# ridge/lasso/elastic regression?
```{r}

```

#